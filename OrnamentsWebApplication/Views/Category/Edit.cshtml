@model OrnamentsWebApplication.ViewModel.CategoryViewModel
@{
    ViewBag.Title = "Edit";

    var trueChecked = Model.isFeatured ? "checked" : string.Empty;
    var falseChecked = !Model.isFeatured ? "checked" : string.Empty;
}


<section>
   
    <div class="container">
        <h2 class="text-center">Edit</h2>
        <form method="post">
            <div class="form-group">
                <label for="exampleInputEmail1">Category</label>
                <input type="text" name="Name" class="form-control col-md-6" value="@Model.Name">
            </div>
            <div class="form-group">
                <label for="exampleInputPassword1">Description</label>
                <input type="text" name="Description" class="form-control col-md-6" value="@Model.Description">

            </div>
            <div class="form-group">
                <label>Upload Image</label>
                <input id="ImageURL" name="ImageURL" type="hidden"/>
                <input id="imageUpload" type="file" name="Image" accept=".png,.jpg,.jpeg" class="form-control col-md-6">
                <div class="thumb">

                    <img id="categoryImage" style="margin-top: 10px" src="@Model.ImageURL">
                </div>
            </div>

            <div style="margin-top: 10px">
                <label>Is Featured?</label>
                <input type="radio" name="isFeatured" value="true" @trueChecked/>True
                <input type="radio" name="isFeatured" value="false" @falseChecked/>False

            </div>
            <button type="submit" class="button">Submit</button>

            @if (ViewBag.message != null)
            {
                <h4 class="text-primary"> @ViewBag.message</h4>
            }
        </form>
    </div>
</section>
<br />
<br />
<section>
    <div class="container">
        <table class="table table-striped table-dark">
            <thead>
            <tr>
                <th scope="col">SL</th>
                <th scope="col">Name</th>
                <th scope="col">Description</th>
                <th scope="col">ImageURL</th>
                <th scope="col">IsFeatured</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            @{int i = 1; }
            @foreach (var categories in Model.Categories)
            {
                <tr>
                    <td>@(i++)</td>
                    <td>@categories.Name</td>
                    <td>@categories.Description</td>
                    <td>@categories.ImageURL</td>
                    <td>@categories.isFeatured</td>

                    <td>
                        @Html.ActionLink("Edit", "Edit", new { id = categories.Id }) |
                        @Html.ActionLink("Delete", "Delete", new { id = categories.Id })
                    </td>
                </tr>

            }


            </tbody>
        </table>
    </div>
</section>

<script>
    $("#imageUpload").change(function () {
        var element = this;

        var formData = new FormData();

        var totalFiles = element.files.length;

        for (var i = 0; i < totalFiles; i++) {
            var file = element.files[i];
            formData.append("Photo", file);
        }

        $.ajax({
                type: 'POST',
                url: '/Shared/UploadImage',
                dataType: 'json',
                data: formData,
                contentType: false,
                processData: false
            })
            
            .done(function(response) {
                console.log(response);
          
                if (response.Success) {
                    $("#ImageURL").val(response.ImageURL);
                    $("#categoryImage").attr("src", response.ImageURL);
                }
            })
            .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                alert("FAIL");
            });
    });
</script>