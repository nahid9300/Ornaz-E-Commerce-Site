@model OrnamentsWebApplication.ViewModel.ProductViewModel

@if (Model != null && Model.Product != null)
{

    var defaultImageURL = "/Content/Design/images/system/placeholder-image.png";

    var imageURL = string.IsNullOrEmpty(Model.Product.ImageURL) ? defaultImageURL : Model.Product.ImageURL;

    <div class="page-title parallax parallax1">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="page-title-heading">
                        <h1 class="title">
                            @Model.Product.Name
                        </h1>
                    </div><!-- /.page-title-heading -->
                </div><!-- /.col-md-12 -->
            </div><!-- /.row -->
        </div><!-- /.container -->
    </div>
    <!-- /.page-title -->

    <section class="flat-row main-shop shop-detail">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <div class="wrap-flexslider">
                        <div class="inner">
                            <div class="flexslider style-1 has-relative">
                                <ul class="">
                                    <li data-thumb="@imageURL">
                                        <img src="@imageURL" alt="Image">
                                        <div class="flat-icon style-1">
                                            <a href="@imageURL" class="zoom-popup"><span class="fa fa-search-plus"></span></a>
                                        </div>
                                    </li>
                                    @*<li data-thumb="images/shop/sh-detail/thumb-detail-02.jpg">
                                            <img src="images/shop/sh-detail/detail-01.jpg" alt="Image">
                                            <div class="flat-icon style-1">
                                                <a href="images/shop/sh-detail/detail-01.jpg" class="zoom-popup"><span class="fa fa-search-plus"></span></a>
                                            </div>
                                        </li>
                                        <li data-thumb="images/shop/sh-detail/thumb-detail-03.jpg">
                                            <img src="images/shop/sh-detail/detail-01.jpg" alt="Image">
                                            <div class="flat-icon style-1">
                                                <a href="images/shop/sh-detail/detail-01.jpg" class="zoom-popup"><span class="fa fa-search-plus"></span></a>
                                            </div>
                                        </li>
                                        <li data-thumb="images/shop/sh-detail/thumb-detail-04.jpg">
                                            <img src="images/shop/sh-detail/detail-01.jpg" alt="Image">
                                            <div class="flat-icon style-1">
                                                <a href="images/shop/sh-detail/detail-01.jpg" class="zoom-popup"><span class="fa fa-search-plus"></span></a>
                                            </div>
                                        </li>*@
                                </ul>
                            </div><!-- /.flexslider -->
                        </div>
                    </div>
                </div><!-- /.col-md-6 -->

                <div class="col-md-6">
                    <div class="product-detail">
                        <div class="inner">
                            <div class="content-detail">
                                <h2 class="product-title">@Model.Product.Name</h2>
                                @*<div class="flat-star style-1">
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star"></i>
                                        <i class="fa fa-star-half-o"></i>
                                        <i class="fa fa-star-half-o"></i>
                                        <span>(1)</span>
                                    </div>*@
                                <p> @Model.Product.Description </p>
                                <div class="price">

                                    <ins>
                                        <span class="amount">
                                            $@Model.Product.Price
                                        </span>
                                    </ins>
                                </div>

                                <div class="product-quantity">
                                    @*<div class="quantity">
                                        <input type="text" value="1" name="quantity-number" class="quantity-number">
                                        <span class="inc quantity-button">+</span>
                                        <span class="dec quantity-button">-</span>
                                    </div>*@
                                    <div class="add-to-cart">
                                        <a class="productAddToCart" data-id="@Model.Product.Id" href="#">ADD TO CART</a>
                                    </div>
                                    @*<div class="box-like">
                                        <a href="#" class="like"><i class="fa fa-heart-o"></i></a>
                                    </div>*@
                                </div>
                                <div class="product-categories">
                                    <span>Categories: </span><a href="#">@Model.Product.Category.Name</a>
                                </div>
                                @*<div class="product-tags">
                                    <span>Tags: </span><a href="#">Dress,</a> <a href="#">Fashion,</a> <a href="#">Furniture,</a> <a href="#">Lookbok</a>
                                </div>
                                <ul class="flat-socials">
                                    <li><a href="#"><i class="fa fa-facebook"></i></a></li>
                                    <li><a href="#"><i class="fa fa-twitter"></i></a></li>
                                    <li><a href="#"><i class="fa fa-pinterest"></i></a></li>
                                    <li><a href="#"><i class="fa fa-linkedin"></i></a></li>
                                    <li><a href="#"><i class="fa fa-google-plus"></i></a></li>
                                </ul>*@
                            </div>
                        </div>
                    </div><!-- /.product-detail -->
                </div>
            </div><!-- /.row -->
        </div><!-- /.container -->
    </section>
    <!-- /.flat-row -->

    <section class="flat-row shop-detail-content">
       
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="flat-tabs style-1 has-border">
                        <div class="inner">
                            <ul class="menu-tab">

                                <li class="active">Reviews</li>
                            </ul>
                            <div class="content-tab">

                                <div class="content-inner">
                                    <div class="inner max-width-83 padding-top-33">
                                        <ol class="review-list">
                                            <li class="review">
                                                <div class="text-wrap">
                                                    
                                                    @if (Model.Reviews != null && Model.Reviews.Count > 0)
                                                    {
                                                        foreach (var review in Model.Reviews)
                                                        {
                                                            <div class="review-meta">
                                                                <h5 class="name">@review.name</h5>
                                                            </div>
                                                            <div class="review-text">
                                                                <p>@review.reviewDetails.</p>
                                                            </div>
                                                        }
                                                    }

                                                    else
                                                    {
                                                        <div class="review-text">
                                                            <p>There are no review of this product.</p>
                                                        </div>
                                                    }
                                                    
                                                </div>
                                                

                                            </li><!--  /.review    -->
                                            <!--  /.review    -->
                                        </ol><!-- /.review-list -->
                                        <div class="comment-respond review-respond" id="respond">
                                            <div class="comment-reply-title margin-bottom-14">
                                                <h5>Write a review</h5>
                                                <p>Your email address will not be published. Required fields are marked *</p>
                                            </div>
                                            <form novalidate="" class="comment-form review-form" id="commentform">

                                                <input type="hidden" name="ProductID" value="@Model.Product.Id"/>

                                                <p class="comment-form-comment">
                                                    <label>Review*</label>
                                                    <textarea class="" id="review" tabindex="4" name="reviewDetails" required placeholder="Write your review"> </textarea>
                                                </p>



                                                <p class="form-submit">
                                                    <button id="placeReview" type="button" class="comment-submit">Leave Review</button>
                                                </p>
                                            </form>
                                        </div><!-- /.comment-respond -->
                                    </div>
                                </div><!-- /.content-inner -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </section>

    <section class="flat-row shop-related">
        <div class="container">
            <div class="row">
                <div class="col-md-12">
                    <div class="title-section margin-bottom-55">
                        <h2 class="title">Related Products</h2>
                    </div>

                    @{
                        Html.RenderAction("Products", "Widgets", new { isLatestProducts = false, categoryID = Model.Product.Category.Id });
                    }
                </div>
            </div><!-- /.row -->
        </div>
    </section>
        }

        <!-- /.shop-detail-content -->
<script>
    //$(".pageDataLink").click(function () {
    //    var url = $(this).attr("data-href");
    //    if (url != "" || url != undefined) {
    //        GetData(url);
    //    }
    //});


    var products;
    $(".productAddToCart").click(function () {
        var existingCookieData = $.cookie('CartProducts');

        if (existingCookieData != undefined && existingCookieData != "" && existingCookieData != null)
        {
            products = existingCookieData.split('-');
        }
        else {
            products = [];
        }

        var productID = $(this).attr('data-id');

        products.push(productID);

        $.cookie('CartProducts', products.join('-'), { path: '/' });

        updateCartProducts();

        swal("Done", "Product Added to Cart!", "success");
    });

</script>

<script>
    $("#placeReview").click(function () {
        $.ajax({
            url: '@Url.Action("GetReview", "Review")',
            type:"post",
            data: $("#commentform").serialize() 
            })
            .done(function (response) {
                if(response.Success)
                {
                    swal("Done", "Your comment has been posted.", "success").then((value) => {
                            window.location.reload();
                        });
                }
                else{
                    swal("Failed", "Your review has not been posted.", "warning");
                }
            })
            .fail(function (XMLHttpRequest, textStatus, errorThrown) {
                alert("FAIL");
            });
    });
</script>